<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrial Clicker: Corporate Edition</title>
    <style>
        :root {
            --primary: #66cc66;
            --bg-dark: #1b2a1d;
            --panel-bg: rgba(0, 0, 0, 0.4);
            --border: #2d4a30;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-dark);
            font-family: 'Segoe UI', sans-serif;
            color: white;
            overflow-x: hidden;
        }

        /* Stats Header */
        .header {
            text-align: center;
            margin-bottom: 20px;
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            border: 1px solid var(--border);
        }

        .credit-display { font-size: 2.5rem; font-weight: bold; color: white; margin: 0; }
        .production-display { color: var(--primary); font-size: 1.1rem; margin-top: 5px; }

        /* Multi-Buy Toggle */
        .buy-modes {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .mode-btn {
            background: #222;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
        }

        .mode-btn.active {
            background: var(--primary);
            color: black;
        }

        /* Main Clicker */
        .circle {
            width: 180px;
            height: 180px;
            background: radial-gradient(circle, #006400 0%, #004d00 100%);
            border: 4px solid var(--primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 0 20px rgba(102, 204, 102, 0.2);
            transition: transform 0.05s;
            margin-bottom: 30px;
        }
        .circle:active { transform: scale(0.92); }

        /* Shop Styling */
        .shop {
            width: 100%;
            max-width: 700px;
        }

        .upgrade-card {
            background: var(--panel-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
            display: grid;
            grid-template-columns: 1fr auto;
            align-items: center;
            gap: 15px;
        }

        .upgrade-info h3 { margin: 0; color: var(--primary); font-size: 1.2rem; }
        .upgrade-info p { margin: 5px 0; font-size: 0.85rem; color: #aaa; line-height: 1.3; }
        .upgrade-stats { font-size: 0.8rem; color: var(--primary); font-weight: bold; }

        .buy-btn {
            background: #004d00;
            color: white;
            border: 1px solid var(--primary);
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            min-width: 140px;
            text-align: center;
        }

        .buy-btn.disabled { opacity: 0.4; cursor: not-allowed; background: #222; border-color: #444; }

        .floating-text {
            position: absolute;
            color: var(--primary);
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 0.7s ease-out forwards;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-80px); opacity: 0; }
        }

        .reset-btn { margin-top: 40px; color: #ff5555; background: none; border: 1px solid #ff5555; cursor: pointer; padding: 5px 10px; border-radius: 4px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="credit-display" id="creditCount">0 Credits</div>
        <div class="production-display">Total Production: <span id="cpsCount">0</span> Credits/sec</div>
    </div>

    <div class="buy-modes">
        <button class="mode-btn active" onclick="setBuyMode(1)">x1</button>
        <button class="mode-btn" onclick="setBuyMode(10)">x10</button>
        <button class="mode-btn" onclick="setBuyMode(100)">x100</button>
        <button class="mode-btn" onclick="setBuyMode('max')">MAX</button>
    </div>

    <div class="circle" id="circle">PRODUCE</div>

    <div class="shop" id="shop-container"></div>

    <button class="reset-btn" onclick="resetGame()">Factory Reset</button>

    <script>
        let credits = 0;
        let buyMode = 1;
        const growthRate = 1.15;

        const upgrades = {
            wrench: { name: "Rusty Wrench", desc: "A basic tool for basic manual labor. Slightly increases click power.", baseCost: 15, addClick: 1, addAuto: 0 },
            worker: { name: "Part-time Worker", desc: "A local hire who clicks while you rest. Produces low output.", baseCost: 100, addClick: 0, addAuto: 1 },
            press: { name: "Steam Press", desc: "A massive iron press. Increases click power significantly.", baseCost: 500, addClick: 8, addAuto: 0 },
            assembly: { name: "Assembly Line", desc: "Modern automation at its finest. High steady output.", baseCost: 1200, addClick: 0, addAuto: 15 },
            manager: { name: "Floor Manager", desc: "They don't work, they just make others work better.", baseCost: 5000, addClick: 0, addAuto: 50 },
            foundry: { name: "Industrial Foundry", desc: "Smelting credits in bulk. Huge automated production.", baseCost: 15000, addClick: 0, addAuto: 150 },
            reactor: { name: "Fusion Reactor", desc: "Tapping into the power of the stars for peak efficiency.", baseCost: 100000, addClick: 1000, addAuto: 1000 }
        };

        let inventory = {};
        Object.keys(upgrades).forEach(id => inventory[id] = 0);

        // --- MATH LOGIC ---

        function getCostOfMany(id, amount) {
            let currentOwned = inventory[id];
            let base = upgrades[id].baseCost;
            
            if (amount === 'max') {
                amount = Math.floor(Math.log((credits * (growthRate - 1)) / (base * Math.pow(growthRate, currentOwned)) + 1) / Math.log(growthRate));
                amount = Math.max(0, amount);
                if (amount === 0) return { cost: base * Math.pow(growthRate, currentOwned), count: 1 };
                return { 
                    cost: base * ( (Math.pow(growthRate, currentOwned) * (Math.pow(growthRate, amount) - 1)) / (growthRate - 1) ),
                    count: amount 
                };
            }

            // Sum of geometric series: Cost = P * (1 - r^n) / (1 - r)
            let totalCost = base * ( (Math.pow(growthRate, currentOwned) * (Math.pow(growthRate, amount) - 1)) / (growthRate - 1) );
            return { cost: totalCost, count: amount };
        }

        function setBuyMode(mode) {
            buyMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.innerText.toLowerCase().includes(mode));
            });
            updateUI();
        }

        // --- CORE FUNCTIONS ---

        function updateUI() {
            document.getElementById('creditCount').innerText = `${Math.floor(credits).toLocaleString()} Credits`;
            
            let totalCps = 0;
            let totalClick = 1;

            Object.keys(upgrades).forEach(id => {
                totalCps += upgrades[id].addAuto * inventory[id];
                totalClick += upgrades[id].addClick * inventory[id];

                const buyData = getCostOfMany(id, buyMode);
                const btn = document.getElementById(`btn-${id}`);
                const countLabel = document.getElementById(`count-${id}`);
                
                btn.innerHTML = `Buy ${buyData.count}<br>${Math.round(buyData.cost).toLocaleString()} C`;
                countLabel.innerText = `Owned: ${inventory[id]}`;
                
                btn.className = (credits >= buyData.cost) ? "buy-btn" : "buy-btn disabled";
                btn.onclick = () => buyItem(id, buyData.count, buyData.cost);
            });

            document.getElementById('cpsCount').innerText = totalCps.toLocaleString();
            document.getElementById('circle').innerText = `+${totalClick.toLocaleString()}`;
            window.currentClickValue = totalClick;
            window.currentCps = totalCps;
        }

        function buyItem(id, count, cost) {
            if (credits >= cost) {
                credits -= cost;
                inventory[id] += count;
                updateUI();
                saveGame();
            }
        }

        // --- INITIALIZE SHOP ---
        const shop = document.getElementById('shop-container');
        Object.keys(upgrades).forEach(id => {
            shop.innerHTML += `
                <div class="upgrade-card">
                    <div class="upgrade-info">
                        <h3>${upgrades[id].name}</h3>
                        <p>${upgrades[id].desc}</p>
                        <div class="upgrade-stats" id="count-${id}">Owned: 0</div>
                    </div>
                    <button class="buy-btn" id="btn-${id}"></button>
                </div>
            `;
        });

        // --- INTERACTIONS ---

        document.getElementById('circle').addEventListener('click', (e) => {
            credits += window.currentClickValue;
            showFloat(e);
            updateUI();
        });

        function showFloat(e) {
            const txt = document.createElement('div');
            txt.className = 'floating-text';
            txt.innerText = `+${window.currentClickValue}`;
            txt.style.left = e.clientX + 'px';
            txt.style.top = e.clientY + 'px';
            document.body.appendChild(txt);
            setTimeout(() => txt.remove(), 700);
        }

        // --- SYSTEMS ---

        function saveGame() {
            localStorage.setItem("IndusClick_V4", JSON.stringify({credits, inventory}));
        }

        function loadGame() {
            const data = JSON.parse(localStorage.getItem("IndusClick_V4"));
            if(data) {
                credits = data.credits;
                inventory = data.inventory;
            }
            updateUI();
        }

        function resetGame() {
            if(confirm("Reset everything?")) {
                localStorage.clear();
                location.reload();
            }
        }

        // Smooth Auto-Production
        setInterval(() => {
            if(window.currentCps > 0) {
                credits += (window.currentCps / 10);
                updateUI();
            }
        }, 100);

        loadGame();
    </script>
</body>
</html>
