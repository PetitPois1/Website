<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Industrial Clicker: Evolution</title>
    <style>
        :root {
            --primary: #66cc66;
            --bg-dark: #1b2a1d;
            --panel-bg: #000000; /* Solid background for mobile scrolling */
            --border: #2d4a30;
            --save-color: #44aaff;
            --quantum: #b300ff;
            --gold: #ffd700;
            --admin: #ff3333;
            --transition-speed: 0.3s;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
            color: white;
            overflow-x: hidden;
            transition: background-color 1s ease;
            min-height: 100vh;
        }

        /* FIXED HEADER AREA */
        .fixed-top {
            position: sticky;
            top: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1000;
            background: var(--panel-bg);
            border-bottom: 2px solid var(--border);
            padding-bottom: 10px;
        }

        .ticker-wrap { 
            width: 100%; 
            background: rgba(0,0,0,0.8); 
            overflow: hidden; 
            white-space: nowrap; 
            padding: 5px 0; 
            font-size: 0.75rem;
        }
        
        .ticker { 
            display: inline-block; 
            padding-left: 100%; 
            animation: ticker 25s linear infinite; 
            color: var(--primary); 
        }
        
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        .header { 
            text-align: center; 
            padding: 15px; 
            width: 100%;
            max-width: 650px;
        }

        .credit-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--primary);
            border-radius: 12px;
            padding: 10px 20px;
            display: inline-block;
            box-shadow: 0 0 15px rgba(102, 204, 102, 0.2);
            margin-bottom: 5px;
        }

        .credit-display { 
            font-size: 1.8rem; 
            font-weight: bold; 
            color: white; 
            margin: 0; 
        }

        .production-display { 
            color: var(--primary); 
            font-size: 0.9rem; 
            font-weight: bold;
        }

        /* SCROLLABLE CONTENT AREA */
        .main-content {
            width: 100%;
            max-width: 700px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .nav-bar { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; justify-content: center; }
        .nav-btn { 
            background: #222; 
            border: 1px solid var(--primary); 
            color: var(--primary); 
            padding: 8px 16px; 
            cursor: pointer; 
            border-radius: 6px; 
            font-weight: bold; 
            font-size: 0.8rem;
        }

        .buy-modes { display: flex; gap: 8px; margin-bottom: 15px; }
        .mode-btn { background: #111; border: 1px solid #444; color: #888; padding: 10px 15px; cursor: pointer; border-radius: 6px; }
        .mode-btn.active { border-color: var(--primary); color: var(--primary); background: #1b2a1d; }

        .click-area { 
            height: 200px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            margin-bottom: 20px; 
            position: relative; 
            width: 100%;
            touch-action: manipulation; /* Prevents double-tap zoom */
        }

        #circle { 
            width: 140px; 
            height: 140px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-weight: bold; 
            cursor: pointer; 
            user-select: none; 
            transition: transform 0.05s; 
            text-align: center; 
            padding: 15px; 
            position: relative; 
            z-index: 5; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }
        #circle:active { transform: scale(0.90); }

        .floating-text { position: absolute; pointer-events: none; color: var(--primary); font-weight: bold; animation: floatUp 0.8s ease-out forwards; z-index: 10; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }

        /* Tier Visuals (Kept exactly as original) */
        .tier-0 { border-radius: 50%; background: #554433; border: 6px solid #332211; }
        .tier-1 { border-radius: 50%; background: #b87333; border: 5px solid #8d5524; }
        .tier-2 { border-radius: 20%; background: #a19d94; border: 5px solid #7a7a7a; }
        .tier-3 { border-radius: 8px;  background: #4682b4; border: 4px solid #2c5272; }
        .tier-4 { border-radius: 0; background: #c0c0c0; border: 4px solid #ffd700; }
        .tier-5 { clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%); background: #1e90ff; border: 2px solid white; }
        .tier-6 { border-radius: 50%; background: radial-gradient(circle, #ff4500, #8b0000); border: 2px solid #ff0; }
        .tier-7 { border-radius: 15px; background: #ff00ff; box-shadow: 0 0 20px #ff00ff; border: none; }
        .tier-8 { border-radius: 50%; background: #000; border: 2px solid #333; box-shadow: 0 0 30px #555; }
        .tier-9 { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; background: var(--quantum); animation: pulse 1.5s infinite; border: none; }
        @keyframes pulse { 0% { box-shadow: 0 0 10px var(--quantum); transform: scale(1); } 50% { box-shadow: 0 0 30px var(--quantum); transform: scale(1.05); } 100% { box-shadow: 0 0 10px var(--quantum); transform: scale(1); } }

        .shop { width: 100%; padding-bottom: 80px; }
        .section-title { color: var(--primary); border-bottom: 1px solid var(--border); margin: 25px 0 10px; padding-bottom: 5px; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        
        .upgrade-card { 
            background: rgba(255,255,255,0.03); 
            border: 1px solid var(--border); 
            border-radius: 10px; 
            padding: 15px; 
            margin-bottom: 12px; 
            display: flex; 
            justify-content: space-between;
            align-items: center; 
            gap: 10px; 
        }

        .buy-btn { 
            background: #0a3d0a; 
            color: white; 
            border: 1px solid var(--primary); 
            padding: 10px; 
            border-radius: 8px; 
            cursor: pointer; 
            min-width: 110px; 
            font-weight: bold; 
            font-size: 0.85rem;
            text-align: center; 
        }
        .buy-btn.disabled { opacity: 0.3; cursor: not-allowed; background: #222; border-color: #444; }

        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); z-index: 2000; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; }
        #toast { position: fixed; top: 20px; right: 20px; background: var(--save-color); padding: 12px 20px; border-radius: 8px; font-weight: bold; opacity: 0; transition: 0.4s; z-index: 3000; pointer-events: none; }
        #toast.show { opacity: 1; }
    </style>
</head>
<body>

    <div id="toast">Saved</div>

    <div class="fixed-top">
        <div class="ticker-wrap"><div class="ticker" id="ticker-text">Welcome to the Industrial Age...</div></div>
        <div class="header" id="main-header">
            <div class="credit-box">
                <div class="credit-display" id="creditCount">0</div>
            </div>
            <div class="production-display">CPS: <span id="cpsCount">0</span></div>
        </div>
    </div>

    <div class="main-content">
        <div class="nav-bar">
            <button class="nav-btn" onclick="toggleOverlay('settings-overlay')">RECORDS</button>
            <button class="nav-btn" onclick="saveGame(); notify('Game Saved!');" style="border-color: var(--save-color); color: var(--save-color);">SAVE</button>
            <button id="admin-nav-btn" class="nav-btn" onclick="toggleOverlay('admin-overlay')" style="display:none; border-color:var(--admin); color:var(--admin);">ADMIN</button>
        </div>

        <div class="buy-modes">
            <button id="mode-1" class="mode-btn active" onclick="setBuyMode(1)">x1</button>
            <button id="mode-10" class="mode-btn" onclick="setBuyMode(10)">x10</button>
            <button id="mode-max" class="mode-btn" onclick="setBuyMode('max')">MAX</button>
        </div>

        <div class="click-area" id="click-parent">
            <div id="circle" class="tier-0">STONE</div>
        </div>

        <div class="shop">
            <h2 class="section-title">EVOLUTION TIERS</h2>
            <div id="tier-container"></div>
            <h2 class="section-title">INFRASTRUCTURE</h2>
            <div id="machine-container"></div>
        </div>
    </div>

    <div id="settings-overlay" class="overlay">
        <button class="nav-btn" onclick="toggleOverlay('settings-overlay')">RETURN</button>
        <h2 class="section-title">ACHIEVEMENTS</h2>
        <div id="ach-container" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; width:100%;"></div>
        <h2 class="section-title">PROMO CODES</h2>
        <div style="display: flex; gap: 10px;">
            <input type="text" id="promo-code" style="padding:10px; background:#111; color:white; border:1px solid var(--primary); width:150px;" placeholder="ENTER CODE">
            <button class="nav-btn" onclick="redeemCode()">SUBMIT</button>
        </div>
        <button class="nav-btn" onclick="resetGame()" style="border-color:#ff5555; color:#ff5555; margin-top:50px;">HARD RESET DATA</button>
    </div>

    <div id="admin-overlay" class="overlay">
        <button class="nav-btn" onclick="toggleOverlay('admin-overlay')">EXIT ADMIN</button>
        <h2 class="section-title" style="color:var(--admin)">DEBUG CONSOLE</h2>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <button class="nav-btn" onclick="credits += 1e9; updateUI();">Add 1 Bil</button>
            <button class="nav-btn" onclick="credits *= 10; updateUI();">x10 Money</button>
            <button class="nav-btn" onclick="adminCompleteGame()">Complete Game</button>
            <button class="nav-btn" onclick="currentTier = 9; updateUI(); applyTierVisuals();">Max Tech</button>
        </div>
    </div>

    <script>
        let credits = 0, totalEarned = 0, totalClicks = 0, currentTier = 0;
        let adminUnlocked = false, unlockedAchievements = [], buyMode = 1;
        let usedCodes = [];
        const growthRate = 1.15;

        function f(n) {
            if (n < 1000) return Math.floor(n).toLocaleString();
            const units = ["k", "Mil", "Bil", "Tril", "Quad", "Quin", "Sext", "Sept", "Oct"];
            const unit = Math.floor((Math.floor(n).toString().length - 1) / 3) * 3;
            const num = (n / ('1e' + unit)).toFixed(2);
            return num + (units[Math.floor(unit / 3) - 1] || "");
        }

        const eraBackgrounds = ["#1b2a1d", "#3d2b1f", "#2b2b2b", "#24243e", "#1a1a2e", "#0f0c29", "#200122", "#000428", "#000000", "#12041d"];

        const tickerData = {
            start: ["Local entrepreneur hits rock with rocks.", "Neighbours file concern report over child labour.", "Bill Rocks: 'Urg ug.', berry stocks rise.", "Scientists wonder if 'Wheel' is a fad."],
            bronze: ["Copper found! Shiny rocks are the new meta.", "Blacksmith accidentally invents the spoon.", "Rock pickers classified as endangered species.", "Tin prices soar as 'Bronze' becomes trending."],
            iron: ["New age underway.", "Swords now 30% pointier.", "Local creates 'Iron-Man' comic.", "Charcoal demand reaches all-time high."],
            steel: ["Bridges are now significantly less likely to collapse.", "Railroads connect towns.", "Steelworkers unionize.", "Tall buildings invented; pigeons excited."],
            factory: ["Smog is the new 'clean air'.", "Child labour replaced by loud steam things.", "Productivity up 400%.", "Standardized screws: The revolution."],
            digital: ["Internet invented; cat drawings everywhere.", "CEO transcends physical form.", "Silicon Valley founded.", "Cloud storage actually just someone else's computer."],
            atomic: ["Nuclear energy: Too cheap to meter.", "Glowing green waste makes for excellent night lights.", "Uranium found in breakfast cereal.", "Fusion is only 20 years away."],
            plasma: ["Plasma cutters make butter knives obsolete.", "Energy grids pulsing with power.", "Magnetic containment leaks lead to 'floating furniture'.", "Neon lights mandatory."],
            void: ["Treasured employees go missing in void well.", "Dark matter: It's what's for dinner.", "Reality starting to look a bit pixelated.", "Nothingness has never been so profitable."],
            quantum: ["Universe.zip successfully extracted.", "Quantum computers solve problems that don't exist yet.", "CEO exists in all offices simultaneously.", "Hacking reality for fun and profit."]
        };

        const achievements = [
            { id: 'a1', name: "Industrialist", desc: "First Click", icon: "ðŸ”¨", check: () => totalClicks >= 1 },
            { id: 'a2', name: "Hobbyist", desc: "100 Clicks", icon: "ðŸ–±ï¸", check: () => totalClicks >= 100 },
            { id: 'a3', name: "Sore Wrists", desc: "1,000 Clicks", icon: "âš¡", check: () => totalClicks >= 1000 },
            { id: 'a4', name: "Pocket Change", desc: "Earn 1k", icon: "ðŸ’°", check: () => totalEarned >= 1000 },
            { id: 'a5', name: "Affluence", desc: "Earn 100k", icon: "ðŸ’Ž", check: () => totalEarned >= 100000 },
            { id: 'a6', name: "Millionaire", desc: "Earn 1Mil", icon: "ðŸ¦", check: () => totalEarned >= 1000000 },
            { id: 'a7', name: "Billionaire", desc: "Earn 1Bil", icon: "ðŸ†", check: () => totalEarned >= 1000000000 },
            { id: 'a8', name: "Bronze Age", desc: "Unlock Bronze", icon: "ðŸ¥‰", check: () => currentTier >= 1 },
            { id: 'a9', name: "Industrialist", desc: "Unlock Factory", icon: "ðŸ­", check: () => currentTier >= 4 },
            { id: 'a10', name: "Godhood", desc: "Unlock Quantum", icon: "ðŸŒŒ", check: () => currentTier >= 9 },
            { id: 'a11', name: "Automation", desc: "Reach 1k CPS", icon: "âš™ï¸", check: () => window.currentCps >= 1000 },
            { id: 'a12', name: "Super Speed", desc: "Reach 1Mil CPS", icon: "ðŸš€", check: () => window.currentCps >= 1000000 }
        ];

        const tierUpgrades = [
            { name: "Bronze Tools", cost: 300, clickValue: 15, label: "BRONZE", class: "tier-1", desc: "Metal hits harder." },
            { name: "Iron Workings", cost: 4000, clickValue: 75, label: "IRON", class: "tier-2", desc: "Sturdier input." },
            { name: "Steel Forging", cost: 50000, clickValue: 450, label: "STEEL", class: "tier-3", desc: "Standardized power." },
            { name: "Machine Automation", cost: 300000, clickValue: 2500, label: "FACTORY", class: "tier-4", desc: "Piston assisted." },
            { name: "Circuitry", cost: 2000000, clickValue: 15000, label: "DIGITAL", class: "tier-5", desc: "Speed of light." },
            { name: "Atomic Synthesis", cost: 15000000, clickValue: 100000, label: "ATOMIC", class: "tier-6", desc: "Nuclear clicks." },
            { name: "Plasma Logic", cost: 120000000, clickValue: 600000, label: "PLASMA", class: "tier-7", desc: "Solar input." },
            { name: "Antimatter", cost: 3000000000, clickValue: 5000000, label: "VOID", class: "tier-8", desc: "Null clicks." },
            { name: "Quantum Core", cost: 60000000000, clickValue: 50000000, label: "QUANTUM", class: "tier-9", desc: "Reality hacking." }
        ];

        const machineUpgrades = {
            gatherer: { name: "Rock Picker", addAuto: 1, baseCost: 25 },
            blacksmith: { name: "Blacksmith", addAuto: 15, baseCost: 400 },
            mill: { name: "Water Wheel", addAuto: 100, baseCost: 4000 },
            engine: { name: "Steam Engine", addAuto: 650, baseCost: 30000 },
            refinery: { name: "Oil Refinery", addAuto: 4500, baseCost: 250000 },
            nuke: { name: "Nuclear Plant", addAuto: 30000, baseCost: 2000000 },
            solar: { name: "Space Solar", addAuto: 200000, baseCost: 30000000 },
            fusion: { name: "Fusion Core", addAuto: 2000000, baseCost: 500000000 },
            swarm: { name: "Dyson Swarm", addAuto: 18000000, baseCost: 10000000000 },
            well: { name: "Void Well", addAuto: 500000000, baseCost: 300000000000 }
        };

        let inventory = {};
        Object.keys(machineUpgrades).forEach(id => inventory[id] = 0);

        function toggleOverlay(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'flex') ? 'none' : 'flex';
        }

        function updateUI() {
            document.getElementById('creditCount').innerText = f(credits);
            
            let totalCps = 0;
            Object.keys(machineUpgrades).forEach(id => totalCps += machineUpgrades[id].addAuto * inventory[id]);
            document.getElementById('cpsCount').innerText = f(totalCps);
            window.currentCps = totalCps;

            let clickVal = (currentTier > 0) ? tierUpgrades[currentTier - 1].clickValue : 1;
            window.currentClickValue = clickVal;

            Object.keys(machineUpgrades).forEach(id => {
                const buyData = getCostOfMany(id, buyMode);
                const btn = document.getElementById(`btn-${id}`);
                btn.innerHTML = `BUY ${buyData.count}<br>${f(buyData.cost)} C`;
                btn.className = (credits >= buyData.cost && buyData.count > 0) ? "buy-btn" : "buy-btn disabled";
                document.getElementById(`info-${id}`).innerHTML = `+${f(machineUpgrades[id].addAuto)} CPS | Owned: ${inventory[id]}`;
            });

            const tBox = document.getElementById('tier-container');
            if (currentTier < tierUpgrades.length) {
                const next = tierUpgrades[currentTier];
                tBox.innerHTML = `
                    <div class="upgrade-card">
                        <div>
                            <h3 style="margin:0;">${next.name}</h3>
                            <p style="font-size:0.8rem; margin:5px 0;">Value: ${f(next.clickValue)}/click</p>
                        </div>
                        <button class="buy-btn ${credits < next.cost ? 'disabled' : ''}" onclick="evolveTier()">
                            EVOLVE<br>${f(next.cost)} C
                        </button>
                    </div>`;
            } else {
                tBox.innerHTML = `<p style="color:var(--quantum); text-align:center;">MAX TECHNOLOGY</p>`;
            }

            if(adminUnlocked) document.getElementById('admin-nav-btn').style.display = 'block';
            document.body.style.backgroundColor = eraBackgrounds[currentTier];
            checkAchievements();
            updateTicker();
        }

        function getCostOfMany(id, amount) {
            let n = inventory[id], b = machineUpgrades[id].baseCost, r = growthRate;
            if (amount === 'max') {
                if (credits < b * Math.pow(r, n)) return { cost: b * Math.pow(r, n), count: 0 };
                amount = Math.floor(Math.log(((credits * (r - 1)) / (b * Math.pow(r, n))) + 1) / Math.log(r));
                amount = Math.max(0, amount);
            }
            let totalCost = b * (Math.pow(r, n) * (Math.pow(r, amount) - 1)) / (r - 1);
            return { cost: totalCost, count: amount };
        }

        function buyMachine(id) {
            const data = getCostOfMany(id, buyMode);
            if(credits >= data.cost && data.count > 0) { 
                credits -= data.cost; 
                inventory[id] += data.count; 
                updateUI(); 
            }
        }

        function evolveTier() {
            const next = tierUpgrades[currentTier];
            if(credits >= next.cost) { 
                credits -= next.cost; 
                currentTier++; 
                applyTierVisuals(); 
                updateUI(); 
                notify("Advanced era!");
            }
        }

        function applyTierVisuals() {
            const c = document.getElementById('circle');
            if(currentTier > 0) {
                const currentData = tierUpgrades[currentTier-1];
                c.className = currentData.class;
                c.innerText = currentData.label;
            } else {
                c.className = "tier-0";
                c.innerText = "STONE";
            }
        }

        function notify(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        function setBuyMode(m) { 
            buyMode = m; 
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active')); 
            if(typeof m === 'number') document.getElementById('mode-'+m).classList.add('active');
            else document.getElementById('mode-max').classList.add('active');
            updateUI(); 
        }

        function saveGame() {
            const data = { credits, totalEarned, totalClicks, inventory, currentTier, unlockedAchievements, adminUnlocked, usedCodes };
            localStorage.setItem("IndusEvo_Mobile_V1", JSON.stringify(data));
        }

        function loadGame() {
            const data = JSON.parse(localStorage.getItem("IndusEvo_Mobile_V1"));
            if(data) {
                credits = data.credits || 0; totalEarned = data.totalEarned || 0; totalClicks = data.totalClicks || 0;
                inventory = data.inventory || inventory; currentTier = data.currentTier || 0;
                unlockedAchievements = data.unlockedAchievements || []; adminUnlocked = data.adminUnlocked || false;
                usedCodes = data.usedCodes || [];
                applyTierVisuals();
            }
            updateUI();
        }

        function redeemCode() {
            const val = document.getElementById('promo-code').value.trim();
            if(val === "Freebie1." && !usedCodes.includes(val)) { 
                credits += 10000; totalEarned += 10000; usedCodes.push(val); notify("+10k Credits!"); 
            } else if(val === "AATESTING." && !usedCodes.includes(val)) { 
                adminUnlocked = true; usedCodes.push(val); notify("Admin Panel Unlocked!"); 
            }
            updateUI();
        }

        function updateTicker() {
            const keys = ["start", "bronze", "iron", "steel", "factory", "digital", "atomic", "plasma", "void", "quantum"];
            const list = tickerData[keys[currentTier] || "start"];
            const tickerEl = document.getElementById('ticker-text');
            if(!list.includes(tickerEl.innerText)) {
                tickerEl.innerText = list[Math.floor(Math.random()*list.length)];
            }
        }

        function checkAchievements() {
            achievements.forEach(ach => {
                if(!unlockedAchievements.includes(ach.id) && ach.check()) {
                    unlockedAchievements.push(ach.id);
                    notify(`Achievement: ${ach.name}`);
                }
            });
        }

        function resetGame() { if(confirm("Delete all progress?")) { localStorage.clear(); location.reload(); } }

        // Click logic
        document.getElementById('circle').addEventListener('click', (e) => {
            credits += window.currentClickValue; totalEarned += window.currentClickValue; totalClicks++;
            const text = document.createElement('div');
            text.className = 'floating-text';
            text.innerText = `+${f(window.currentClickValue)}`;
            text.style.left = (Math.random() * 60 + 20) + '%';
            document.getElementById('click-parent').appendChild(text);
            setTimeout(() => text.remove(), 800);
            updateUI();
        });

        // Initialize Shop
        const mBox = document.getElementById('machine-container');
        Object.keys(machineUpgrades).forEach(id => {
            mBox.innerHTML += `<div class="upgrade-card"><div><h3 style="margin:0; font-size:1rem;">${machineUpgrades[id].name}</h3><p id="info-${id}" style="margin:5px 0; font-size:0.75rem;"></p></div><button class="buy-btn" id="btn-${id}" onclick="buyMachine('${id}')"></button></div>`;
        });

        setInterval(() => { if(window.currentCps > 0) { credits += window.currentCps/10; totalEarned += window.currentCps/10; updateUI(); } }, 100);
        setInterval(saveGame, 30000);
        loadGame();
    </script>
</body>
</html>
