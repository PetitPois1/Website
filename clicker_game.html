<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Industrial Clicker: Evolution</title>
    <style>
        :root {
            --primary: #66cc66;
            --bg-dark: #1b2a1d;
            --panel-bg: #000000; 
            --border: #2d4a30;
            --save-color: #44aaff;
            --quantum: #b300ff;
            --gold: #ffd700;
            --admin: #ff3333;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            background-color: var(--bg-dark);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
            overflow-x: hidden;
            transition: background-color 1s ease;
            min-height: 100vh;
        }

        /* FIXED HEADER */
        .fixed-top {
            position: sticky;
            top: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1000;
            background: var(--panel-bg);
            border-bottom: 2px solid var(--border);
        }

        .ticker-wrap { 
            width: 100%; 
            background: rgba(0,0,0,0.9); 
            overflow: hidden; 
            white-space: nowrap; 
            padding: 10px 0; 
            border-bottom: 1px solid #333;
        }
        
        .ticker { 
            display: inline-block; 
            padding-left: 100%; 
            animation: ticker 25s linear infinite; 
            color: var(--primary); 
            font-weight: bold;
        }
        
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        .header { text-align: center; padding: 15px; width: 100%; }

        .credit-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--primary);
            border-radius: 12px;
            padding: 10px 25px;
            display: inline-block;
            transition: transform 0.1s;
        }

        .credit-display { font-size: 2rem; font-weight: 900; color: white; margin: 0; }
        .currency-label { font-size: 0.7rem; color: var(--primary); letter-spacing: 2px; display: block; margin-top: -5px; }
        .production-display { color: var(--primary); font-size: 0.9rem; font-weight: bold; margin-top: 5px; }

        /* MAIN CONTENT */
        .main-content { width: 100%; max-width: 600px; padding: 20px; display: flex; flex-direction: column; align-items: center; }

        .nav-bar { display: flex; gap: 8px; margin-bottom: 15px; }
        .nav-btn { 
            background: #222; border: 1px solid var(--primary); color: var(--primary); 
            padding: 8px 12px; cursor: pointer; border-radius: 6px; font-weight: bold; font-size: 0.75rem;
        }

        .buy-modes { display: flex; gap: 5px; margin-bottom: 20px; }
        .mode-btn { background: #111; border: 1px solid #444; color: #888; padding: 8px 15px; cursor: pointer; border-radius: 6px; }
        .mode-btn.active { border-color: var(--primary); color: var(--primary); background: #1b2a1d; }

        .click-area { 
            height: 180px; display: flex; justify-content: center; align-items: center; 
            margin-bottom: 30px; position: relative; width: 100%; touch-action: manipulation; 
        }

        #circle { 
            width: 130px; height: 130px; display: flex; justify-content: center; align-items: center; 
            font-weight: 900; cursor: pointer; user-select: none; transition: transform 0.05s; 
            text-align: center; padding: 10px; z-index: 5; box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }
        #circle:active { transform: scale(0.92); }

        .floating-text { position: absolute; pointer-events: none; color: var(--primary); font-weight: bold; animation: floatUp 0.7s ease-out forwards; z-index: 10; font-size: 1.2rem; }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-80px); } }

        /* TIERS */
        .tier-0 { border-radius: 50%; background: #554433; border: 6px solid #332211; }
        .tier-1 { border-radius: 50%; background: #b87333; border: 5px solid #8d5524; }
        .tier-2 { border-radius: 20%; background: #a19d94; border: 5px solid #7a7a7a; }
        .tier-3 { border-radius: 8px;  background: #4682b4; border: 4px solid #2c5272; }
        .tier-4 { border-radius: 0; background: #c0c0c0; border: 4px solid #ffd700; }
        .tier-5 { clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%); background: #1e90ff; }
        .tier-9 { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; background: var(--quantum); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); box-shadow: 0 0 10px var(--quantum); } 50% { transform: scale(1.05); box-shadow: 0 0 30px var(--quantum); } }

        /* SHOP */
        .shop { width: 100%; padding-bottom: 50px; }
        .section-title { color: var(--primary); border-bottom: 1px solid var(--border); margin: 20px 0 10px; padding-bottom: 5px; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; }
        
        .upgrade-card { 
            background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 10px; 
            padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; 
        }

        .buy-btn { 
            background: #0a3d0a; color: white; border: 1px solid var(--primary); 
            padding: 8px; border-radius: 6px; cursor: pointer; min-width: 100px; 
            font-weight: bold; font-size: 0.8rem; text-align: center; 
        }
        .buy-btn.disabled { opacity: 0.3; cursor: not-allowed; background: #222; border-color: #444; }

        /* OVERLAYS */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-dark); z-index: 2000; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; }
        .ach-card { background: #222; padding: 10px; border-radius: 8px; border: 1px solid #444; text-align: center; opacity: 0.4; }
        .ach-card.unlocked { opacity: 1; border-color: var(--gold); }

        #toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: var(--save-color); padding: 12px 24px; border-radius: 50px; font-weight: bold; opacity: 0; transition: 0.3s; z-index: 3000; pointer-events: none; }
        #toast.show { opacity: 1; bottom: 40px; }
    </style>
</head>
<body>

    <div id="toast">Saved</div>

    <div class="fixed-top">
        <div class="ticker-wrap"><div class="ticker" id="ticker-text">Loading simulation...</div></div>
        <div class="header">
            <div class="credit-box" id="credit-container">
                <div class="credit-display" id="creditCount">0</div>
                <span class="currency-label">CREDITS</span>
            </div>
            <div class="production-display">AUTO: <span id="cpsCount">0</span>/sec</div>
        </div>
    </div>

    <div class="main-content">
        <div class="nav-bar">
            <button class="nav-btn" onclick="openRecords()">RECORDS</button>
            <button class="nav-btn" onclick="saveGame(true)" style="color: var(--save-color); border-color: var(--save-color);">SAVE</button>
            <button id="admin-nav-btn" class="nav-btn" onclick="toggleOverlay('admin-overlay')" style="display:none; color:var(--admin); border-color:var(--admin);">ADMIN</button>
        </div>

        <div class="buy-modes">
            <button id="mode-1" class="mode-btn active" onclick="setBuyMode(1)">x1</button>
            <button id="mode-10" class="mode-btn" onclick="setBuyMode(10)">x10</button>
            <button id="mode-max" class="mode-btn" onclick="setBuyMode('max')">MAX</button>
        </div>

        <div class="click-area" id="click-parent">
            <div id="circle" class="tier-0">STONE</div>
        </div>

        <div class="shop">
            <h2 class="section-title">Evolution Pathway</h2>
            <div id="tier-container"></div>
            <h2 class="section-title">Industrial Infrastructure</h2>
            <div id="machine-container"></div>
        </div>
    </div>

    <div id="settings-overlay" class="overlay">
        <button class="nav-btn" onclick="toggleOverlay('settings-overlay')">BACK TO GAME</button>
        <h2 class="section-title">Milestones</h2>
        <div id="ach-container" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; width:100%;"></div>
        
        <h2 class="section-title">Data Management</h2>
        <input type="text" id="promo-code" style="padding:12px; background:#000; color:white; border:1px solid var(--primary); width:100%; margin-bottom:10px;" placeholder="PROMO CODE">
        <button class="nav-btn" style="width:100%" onclick="redeemCode()">REDEEM</button>
        
        <button class="nav-btn" onclick="resetGame()" style="border-color:#ff5555; color:#ff5555; margin-top:40px; width: 100%;">ERASE ALL DATA</button>
    </div>

    <div id="admin-overlay" class="overlay">
        <button class="nav-btn" onclick="toggleOverlay('admin-overlay')">EXIT DEBUG</button>
        <h2 class="section-title" style="color:var(--admin)">Cheat Console</h2>
        <div style="display:grid; grid-template-columns: 1fr; gap:10px; width: 100%;">
            <button class="nav-btn" onclick="credits += 1e9; updateUI();">Add 1 Billion</button>
            <button class="nav-btn" onclick="currentTier = 9; applyTierVisuals(); updateUI();">Unlock Max Tier</button>
        </div>
    </div>

    <script>
        let credits = 0, totalEarned = 0, totalClicks = 0, currentTier = 0;
        let adminUnlocked = false, unlockedAchievements = [], buyMode = 1, usedCodes = [];
        const growthRate = 1.15;

        // Formatter
        function f(n) {
            if (n < 1000) return Math.floor(n).toLocaleString();
            const units = ["k", "M", "B", "T", "Qa", "Qi", "Sx"];
            const unitIndex = Math.floor((Math.log10(n) / 3));
            const num = (n / Math.pow(10, unitIndex * 3)).toFixed(2);
            return num + (units[unitIndex - 1] || "");
        }

        const eraBackgrounds = ["#1b2a1d", "#3d2b1f", "#2b2b2b", "#24243e", "#1a1a2e", "#0f0c29", "#200122", "#000428", "#000000", "#12041d"];
        
        const tickerData = {
            start: ["Local entrepreneur hits rock with rocks.", "Scientists wonder if 'wheel' is a fad."],
            bronze: ["Copper found! Shiny rocks are the new meta.", "Blacksmith accidentally invents the spoon."],
            iron: ["Iron swords now 30% pointier.", "Iron-working: It's heavy, but it works."],
            steel: ["Bridges are now 80% less likely to collapse.", "Railroads connect the kitchen to the living room."],
            factory: ["Smog is the new 'clean air'.", "Steam engines outperforming horses 10 to 1."],
            digital: ["The internet: mostly just cat pictures.", "CEO is now 40% silicon."],
            atomic: ["Nuclear energy: Glowing in the dark is a feature.", "Fusion is still 20 years away."],
            plasma: ["Neon lights are now mandatory for all citizens.", "Plasma cutters making butter knives obsolete."],
            void: ["Void wells are 'completely safe', says CEO.", "Reality starting to look pixelated."],
            quantum: ["Reality successfully hacked.", "CEO exists in all offices simultaneously."]
        };

        const achievements = [
            { id: 'a1', name: "Beginner", desc: "1st Click", icon: "ðŸ”¨", check: () => totalClicks >= 1 },
            { id: 'a2', name: "Grinder", desc: "100 Clicks", icon: "ðŸ–±ï¸", check: () => totalClicks >= 100 },
            { id: 'a3', name: "Wealthy", desc: "1M Earned", icon: "ðŸ’°", check: () => totalEarned >= 1000000 },
            { id: 'a4', name: "Modern", desc: "Factory Era", icon: "ðŸ­", check: () => currentTier >= 4 },
            { id: 'a5', name: "Ascended", desc: "Quantum Era", icon: "ðŸŒŒ", check: () => currentTier >= 9 }
        ];

        const tierUpgrades = [
            { name: "Bronze Tools", cost: 300, clickValue: 10, label: "BRONZE", class: "tier-1" },
            { name: "Iron Workings", cost: 5000, clickValue: 60, label: "IRON", class: "tier-2" },
            { name: "Steel Forging", cost: 75000, clickValue: 400, label: "STEEL", class: "tier-3" },
            { name: "Steam Power", cost: 500000, clickValue: 2000, label: "FACTORY", class: "tier-4" },
            { name: "Digital Logic", cost: 10000000, clickValue: 15000, label: "DIGITAL", class: "tier-5" },
            { name: "Quantum Core", cost: 1e11, clickValue: 1e7, label: "QUANTUM", class: "tier-9" }
        ];

        const machineUpgrades = {
            picker: { name: "Rock Picker", addAuto: 1, baseCost: 15 },
            smith: { name: "Blacksmith", addAuto: 8, baseCost: 150 },
            mill: { name: "Water Wheel", addAuto: 45, baseCost: 1200 },
            engine: { name: "Steam Engine", addAuto: 250, baseCost: 15000 },
            plant: { name: "Power Plant", addAuto: 1800, baseCost: 200000 },
            server: { name: "Data Center", addAuto: 12000, baseCost: 3000000 }
        };

        let inventory = {};
        Object.keys(machineUpgrades).forEach(id => inventory[id] = 0);

        function toggleOverlay(id) {
            const el = document.getElementById(id);
            el.style.display = (el.style.display === 'flex') ? 'none' : 'flex';
        }

        function openRecords() {
            const container = document.getElementById('ach-container');
            container.innerHTML = '';
            achievements.forEach(ach => {
                const isUnlocked = unlockedAchievements.includes(ach.id);
                container.innerHTML += `
                    <div class="ach-card ${isUnlocked ? 'unlocked' : ''}">
                        <div style="font-size:1.5rem">${ach.icon}</div>
                        <div style="font-weight:bold; font-size:0.8rem">${ach.name}</div>
                        <div style="font-size:0.6rem">${ach.desc}</div>
                    </div>
                `;
            });
            toggleOverlay('settings-overlay');
        }

        function updateUI() {
            document.getElementById('creditCount').innerText = f(credits);
            
            let totalCps = 0;
            Object.keys(machineUpgrades).forEach(id => totalCps += machineUpgrades[id].addAuto * inventory[id]);
            document.getElementById('cpsCount').innerText = f(totalCps);
            window.currentCps = totalCps;

            let clickVal = (currentTier > 0) ? tierUpgrades[currentTier - 1].clickValue : 1;
            window.currentClickValue = clickVal;

            Object.keys(machineUpgrades).forEach(id => {
                const buyData = getCostOfMany(id, buyMode);
                const btn = document.getElementById(`btn-${id}`);
                btn.innerHTML = `BUY ${buyData.count}<br>${f(buyData.cost)}`;
                btn.className = (credits >= buyData.cost && buyData.count > 0) ? "buy-btn" : "buy-btn disabled";
                document.getElementById(`info-${id}`).innerHTML = `+${f(machineUpgrades[id].addAuto)}/s | Fleet: ${inventory[id]}`;
            });

            const tBox = document.getElementById('tier-container');
            const next = tierUpgrades[currentTier];
            if (next) {
                tBox.innerHTML = `
                    <div class="upgrade-card">
                        <div>
                            <h3 style="margin:0;">${next.name}</h3>
                            <p style="font-size:0.7rem; margin:5px 0;">Efficiency: ${f(next.clickValue)}/click</p>
                        </div>
                        <button class="buy-btn ${credits < next.cost ? 'disabled' : ''}" onclick="evolveTier()">
                            EVOLVE<br>${f(next.cost)}
                        </button>
                    </div>`;
            } else {
                tBox.innerHTML = `<p style="color:var(--quantum); text-align:center; width:100%">ULTIMATE EVOLUTION REACHED</p>`;
            }

            if(adminUnlocked) document.getElementById('admin-nav-btn').style.display = 'block';
            document.body.style.backgroundColor = eraBackgrounds[currentTier] || "#000";
            checkAchievements();
        }

        function getCostOfMany(id, amount) {
            let n = inventory[id], b = machineUpgrades[id].baseCost, r = growthRate;
            if (amount === 'max') {
                amount = Math.floor(Math.log(((credits * (r - 1)) / (b * Math.pow(r, n))) + 1) / Math.log(r));
                amount = Math.max(0, amount);
            }
            let totalCost = b * (Math.pow(r, n) * (Math.pow(r, amount) - 1)) / (r - 1);
            return { cost: totalCost, count: amount };
        }

        function buyMachine(id) {
            const data = getCostOfMany(id, buyMode);
            if(credits >= data.cost && data.count > 0) { 
                credits -= data.cost; 
                inventory[id] += data.count; 
                updateUI(); 
            }
        }

        function evolveTier() {
            const next = tierUpgrades[currentTier];
            if(credits >= next.cost) { 
                credits -= next.cost; 
                currentTier++; 
                applyTierVisuals(); 
                updateUI(); 
                notify("ERA ADVANCED!");
                updateTicker(true);
            }
        }

        function applyTierVisuals() {
            const c = document.getElementById('circle');
            if(currentTier > 0) {
                const currentData = tierUpgrades[currentTier-1];
                c.className = currentData.class;
                c.innerText = currentData.label;
            } else {
                c.className = "tier-0";
                c.innerText = "STONE";
            }
        }

        function notify(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2000);
        }

        function setBuyMode(m) { 
            buyMode = m; 
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active')); 
            document.getElementById(typeof m === 'number' ? 'mode-'+m : 'mode-max').classList.add('active');
            updateUI(); 
        }

        function saveGame(manual = false) {
            const data = { credits, totalEarned, totalClicks, inventory, currentTier, unlockedAchievements, adminUnlocked, usedCodes };
            localStorage.setItem("IndusEvo_V1", JSON.stringify(data));
            if(manual) notify("Progress Saved");
        }

        function loadGame() {
            const data = JSON.parse(localStorage.getItem("IndusEvo_V1"));
            if(data) {
                credits = data.credits; totalEarned = data.totalEarned; totalClicks = data.totalClicks;
                inventory = data.inventory; currentTier = data.currentTier;
                unlockedAchievements = data.unlockedAchievements; adminUnlocked = data.adminUnlocked;
                usedCodes = data.usedCodes || [];
                applyTierVisuals();
            }
            updateUI();
            updateTicker(true);
        }

        function updateTicker(force = false) {
            const keys = ["start", "bronze", "iron", "steel", "factory", "digital", "atomic", "plasma", "void", "quantum"];
            const list = tickerData[keys[currentTier]] || tickerData.start;
            const tickerEl = document.getElementById('ticker-text');
            tickerEl.innerText = list[Math.floor(Math.random()*list.length)];
        }

        function checkAchievements() {
            achievements.forEach(ach => {
                if(!unlockedAchievements.includes(ach.id) && ach.check()) {
                    unlockedAchievements.push(ach.id);
                    notify(`UNLOCKED: ${ach.name}`);
                }
            });
        }

        function redeemCode() {
            const val = document.getElementById('promo-code').value.toUpperCase();
            if(val === "EVOLVE" && !usedCodes.includes(val)) {
                credits += 5000; usedCodes.push(val); notify("+5,000 Credits!");
            } else if (val === "BEANS") {
                adminUnlocked = true; notify("Debug Mode Active");
            }
            updateUI();
        }

        function resetGame() { if(confirm("Reset everything?")) { localStorage.clear(); location.reload(); } }

        document.getElementById('circle').addEventListener('click', (e) => {
            credits += window.currentClickValue; 
            totalEarned += window.currentClickValue; 
            totalClicks++;
            
            // Visual feedback
            const container = document.getElementById('credit-container');
            container.style.transform = "scale(1.05)";
            setTimeout(() => container.style.transform = "scale(1)", 50);

            const text = document.createElement('div');
            text.className = 'floating-text';
            text.innerText = `+${f(window.currentClickValue)}`;
            text.style.left = (Math.random() * 60 + 20) + '%';
            document.getElementById('click-parent').appendChild(text);
            setTimeout(() => text.remove(), 700);
            updateUI();
        });

        // Initialize Shop
        const mBox = document.getElementById('machine-container');
        Object.keys(machineUpgrades).forEach(id => {
            mBox.innerHTML += `
                <div class="upgrade-card">
                    <div>
                        <h3 style="margin:0; font-size:0.9rem;">${machineUpgrades[id].name}</h3>
                        <p id="info-${id}" style="margin:5px 0; font-size:0.7rem; color:#aaa;"></p>
                    </div>
                    <button class="buy-btn" id="btn-${id}" onclick="buyMachine('${id}')"></button>
                </div>`;
        });

        // Intervals
        setInterval(() => { if(window.currentCps > 0) { credits += window.currentCps/10; totalEarned += window.currentCps/10; updateUI(); } }, 100);
        setInterval(updateTicker, 15000);
        setInterval(saveGame, 60000);
        
        loadGame();
    </script>
</body>
</html>
